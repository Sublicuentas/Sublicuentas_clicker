<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Subli Gaming</title>
<style>
  :root{ --bg:#0b1223; --panel:#101a33; --text:#e5e7eb; --brand:#ff2d55; --brand2:#5dd0ff; }
  html,body{margin:0;height:100%;background:radial-gradient(1200px 800px at 20% 0%, #10224a, var(--bg));font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",sans-serif;color:var(--text);}
  #ui{position:fixed;inset:0;display:grid;place-items:center;pointer-events:none}
  .card{pointer-events:auto;background:rgb(16 26 51 / 70%);backdrop-filter: blur(10px);border:1px solid rgb(255 255 255 / 10%);padding:24px;border-radius:20px;box-shadow:0 10px 40px rgb(0 0 0 / 50%);max-width:820px}
  h1{margin:10px 0 8px;font-size:44px;letter-spacing:.6px;font-weight:900;background:linear-gradient(90deg,#ff2d55,#5dd0ff);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 10px rgba(255,45,85,.45),0 0 22px rgba(93,208,255,.35),0 6px 30px rgba(0,0,0,.5)}
  .levels{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;border:1px solid rgb(255 255 255 / 18%);padding:12px 18px;border-radius:14px;cursor:pointer;font-weight:800;background:linear-gradient(135deg,#0e1a33,#0a1428);color:var(--text);box-shadow:0 6px 16px rgb(0 0 0 / 30%);transition:.2s transform,.2s box-shadow}
  .btn:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgb(0 0 0 / 40%)}
  .btn.primary{border-color:transparent;background:linear-gradient(135deg,var(--brand),var(--brand2));color:#07101e}
  .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
  #hud{position:fixed;top:8px;left:8px;right:8px;display:flex;justify-content:space-between;align-items:center;font-weight:800;text-shadow:0 2px 6px rgba(0,0,0,.6)}
  #hud .pill{background:rgb(255 255 255 / 12%);padding:8px 12px;border-radius:999px;border:1px solid rgb(255 255 255 / 18%);display:flex;align-items:center;gap:8px}
  #effects{display:flex;gap:8px;align-items:center}
  .eff{padding:4px 8px;border-radius:999px;background:rgb(255 255 255 / 14%);border:1px solid rgb(255 255 255 / 18%);font-size:12px}
  canvas{display:block;width:100vw;height:100vh;touch-action:none}
  .hint{font-size:16px;opacity:.95;line-height:1.5}
  .logo{width:min(320px,70vw);height:auto;filter: drop-shadow(0 0 12px rgba(255,45,85,.55)) drop-shadow(0 10px 24px rgba(0,0,0,.6));}
  #splash{position:fixed;inset:0;display:grid;place-items:center;background:radial-gradient(800px 600px at 50% 30%, #141e38, #0b1223);z-index:9999}
  .s-inner{display:flex;flex-direction:column;align-items:center;gap:16px}
  .s-logo{width:min(260px,60vw);height:auto;animation:pop 900ms ease-out forwards;filter: drop-shadow(0 14px 38px rgba(0,0,0,.5));}
  .s-title{font-weight:900;font-size:34px;background:linear-gradient(90deg,#ff2d55,#5dd0ff);-webkit-background-clip:text;background-clip:text;color:transparent;letter-spacing:.7px;opacity:0;animation:fade 1s .2s forwards;text-shadow:0 0 14px rgba(255,45,85,.45),0 0 22px rgba(93,208,255,.35)}
  .spinner{width:42px;height:42px;border-radius:50%;border:4px solid rgba(255,255,255,.25);border-top-color:#5dd0ff;animation:spin 900ms linear infinite}
  @keyframes pop{0%{transform:scale(.6);opacity:0}60%{transform:scale(1.06);opacity:1}100%{transform:scale(1)}}
  @keyframes fade{to{opacity:1}}
  @keyframes spin{to{transform:rotate(360deg)}}
  .hide{animation:fadeOut .5s forwards}
  @keyframes fadeOut{to{opacity:0;visibility:hidden}}
  .banners{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:8px}
  .banners img{width:300px;height:100px;border-radius:12px;border:1px solid rgb(255 255 255 / 14%);box-shadow:0 6px 16px rgba(0,0,0,.35)}
</style>
</head>
<body>
<canvas id="game"></canvas>

<!-- Splash con banners -->
<div id="splash">
  <div class="s-inner">
    <img src="logo.png" alt="Subli Gaming" class="s-logo">
    <div class="s-title">Subli Gaming</div>
    <div class="spinner" aria-label="Cargando"></div>
    <div class="banners">
      <img src="data:image/png;base64,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" alt="Banner 1">
      <img src="data:image/png;base64,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" alt="Banner 2">
    </div>
  </div>
</div>

<!-- HUD -->
<div id="hud" style="display:none">
  <div class="pill">⏱️ <span id="time">30.0</span>s</div>
  <div class="pill">⭐ Puntos: <span id="score">0</span></div>
  <div class="pill">💥 Combo: <span id="combo">x1</span></div>
  <div class="pill">❤️ <span id="lives">3</span></div>
  <div class="pill">🎯 <span id="levelname">-</span></div>
  <div class="pill" id="effects"><span class="eff" id="effDP" style="display:none">⭐ x2</span><span class="eff" id="effFreeze" style="display:none">⏰ +5s</span><span class="eff" id="effShield" style="display:none">🛡 1</span></div>
</div>

<!-- UI -->
<div id="ui">
  <div id="start" class="card" style="display:none">
    <div style="display:grid;place-items:center">
      <img src="logo.png" alt="Subli Gaming" class="logo">
      <h1>Subli Gaming</h1>
      <ul class="hint">
        <li><b>Toque solo los círculos</b> con nombres de plataformas para sumar puntos.</li>
        <li><b>Evite tocar otra figura</b> (cuadrado, rectángulo, triángulo): <b>−10 pts</b> y <b>−1 vida</b>.</li>
        <li><b>Power-ups:</b> ⭐ Doble puntos (10s), ⏰ Congela tiempo (5s), 🛡 Protección de una vida.</li>
        <li><b>Duración:</b> <b>30 segundos</b>.</li>
      </ul>
      <!-- Banners persistentes con rotación lenta -->
      <div class="banners">
        <img id="rotBanner" src="data:image/png;base64,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" alt="Banner rotatorio">
      </div>
    </div>
    <div class="levels" style="margin-top:6px">
      <button class="btn primary" data-level="beginner">Principiante (+5)</button>
      <button class="btn" data-level="intermediate">Intermedio (+10)</button>
      <button class="btn" data-level="advanced">Avanzado (+15)</button>
    </div>
    <div class="row" style="margin-top:10px">
      <button class="btn" id="how">¿Cómo reclamo premio?</button>
      <button class="btn" id="toggleFS">Pantalla completa</button>
    </div>
  </div>
  <div id="howcard" class="card" style="display:none">
    <h1>🎁 ¿Cómo reclamo premio?</h1>
    <ol style="padding-left:18px;line-height:1.5">
      <li>Juegue y obtenga su <b>puntaje</b>.</li>
      <li>Al finalizar, toque <b>Reclamar por WhatsApp</b>.</li>
      <li>Se abrirá un mensaje con su <b>puntaje</b> y “Quiero reclamar mi premio”. Envíelo.</li>
    </ol>
    <div class="row"><button class="btn primary" id="backToStart">Volver</button></div>
  </div>
  <div id="gameover" class="card" style="display:none"></div>
</div>

<script>
// ===== Utils
const lerp=(a,b,t)=>a+(b-a)*t;
const rand=(min,max)=>Math.random()*(max-min)+min;

// ===== Canvas
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
function resize(){ canvas.width=innerWidth*2; canvas.height=innerHeight*2; }
addEventListener('resize',resize); resize();

// Splash más lento (3s) y banners rotativos en start
window.addEventListener('load', ()=>{
  setTimeout(()=>{
    document.getElementById('splash').classList.add('hide');
    setTimeout(()=>{ document.getElementById('start').style.display='block'; }, 450);
  }, 3000);
  // rotación lenta (6s)
  const imgs = ['data:image/png;base64,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','data:image/png;base64,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'];
  let idx=0;
  setInterval(()=>{
    idx=(idx+1)%imgs.length;
    document.getElementById('rotBanner').src = imgs[idx];
  }, 6000);
});

// ===== Difficulty
const DIFFICULTY = {
  beginner:    { name:'Principiante', points:5, time:30, speed:0.7, spawn:0.85 },
  intermediate:{ name:'Intermedio',  points:10, time:30, speed:1.0, spawn:1.0 },
  advanced:    { name:'Avanzado',    points:15, time:30, speed:1.15, spawn:1.1 }
};
let currentDiff = DIFFICULTY.beginner;

// ===== State
let running=false, timeLeft=30, score=0, combo=1, lives=3;
let lastTime=0, spawnTimer=0, targets=[]; 
let shake=0;
const PENALTY = 10; 
const COLORS = ['#22c55e','#3b82f6','#a855f7','#ef4444','#f59e0b','#e11d48','#06b6d4','#10b981','#f97316','#84cc16','#38bdf8','#f43f5e'];

// Power-ups state
let doublePointsTimer = 0, timeFreezeTimer = 0, shieldCharges = 0;

// HUD
function updateHUD(show){
  document.getElementById('hud').style.display=show?'flex':'none';
  document.getElementById('score').textContent=score;
  document.getElementById('time').textContent=timeLeft.toFixed(1);
  document.getElementById('combo').textContent='x'+(Math.round(combo*10)/10);
  document.getElementById('lives').textContent=lives;
  document.getElementById('levelname').textContent=currentDiff.name;
  document.getElementById('effDP').style.display = doublePointsTimer>0 ? 'inline-block':'none';
  document.getElementById('effFreeze').style.display = timeFreezeTimer>0 ? 'inline-block':'none';
  document.getElementById('effShield').style.display = shieldCharges>0 ? 'inline-block':'none';
}

// Content
const PLATFORM_NAMES = ['NETFLIX','DEEZER','DISNEY+','CRUNCHYROLL','PRIME VIDEO','HBO MAX','VIX','PARAMOUNT+','FREE FIRE','CANVA','MAGIS','UMBRA'];
const DECOY_NAMES = ['CUADRADO','RECTÁNGULO','TRIÁNGULO'];

// ===== Entities
class Target{
  constructor(kind=null){
    const pad=100;
    this.r = rand(65,110);
    this.x = rand(pad, canvas.width-pad);
    this.y = rand(pad, canvas.height-pad);
    this.life = 0.9;
    this.hit=false;
    if(kind) this.kind=kind;
    else if(Math.random()<0.5) this.kind='circle';
    else this.kind = ['square','rect','triangle'][Math.floor(Math.random()*3)];
    this.label = this.kind==='circle' ? PLATFORM_NAMES[Math.floor(Math.random()*PLATFORM_NAMES.length)] : DECOY_NAMES[['square','rect','triangle'].indexOf(this.kind)];
    this.color = COLORS[Math.floor(Math.random()*COLORS.length)];
    const m = currentDiff.speed || 1;
    this.vx = rand(-80,80)*m; this.vy = rand(-80,80)*m; this.spin = rand(-3,3)*m;
    this.rotation = Math.random()*Math.PI*2;
  }
  update(dt){
    this.life -= dt;
    this.x += this.vx*dt; this.y += this.vy*dt; this.rotation += this.spin*dt*0.45;
    if(this.x < 100 || this.x > canvas.width-100) this.vx *= -1;
    if(this.y < 100 || this.y > canvas.height-100) this.vy *= -1;
  }
  draw(){
    const {x,y,r,kind} = this;
    ctx.save(); ctx.translate(x,y); ctx.rotate(this.rotation);
    const g=ctx.createRadialGradient(0,0,0,0,0,r*1.4);
    g.addColorStop(0, this.color + 'aa'); g.addColorStop(1, 'transparent');
    ctx.globalAlpha=0.35; ctx.fillStyle=g; ctx.beginPath(); ctx.arc(0,0,r*1.4,0,Math.PI*2); ctx.fill(); ctx.globalAlpha=1;
    ctx.fillStyle = this.color; ctx.strokeStyle='rgba(255,255,255,.95)'; ctx.lineWidth=8;
    let maxTextW;
    if(kind==='circle'){ ctx.beginPath(); ctx.arc(0,0,r,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(0,0,r-8,0,Math.PI*2); ctx.stroke(); maxTextW = r*1.40; }
    else if(kind==='square'){ const s=r*1.5; ctx.beginPath(); ctx.rect(-s/2,-s/2,s,s); ctx.fill(); ctx.strokeRect(-s/2+8,-s/2+8,s-16,s-16); maxTextW=s*0.78; }
    else if(kind==='rect'){ const w=r*2.2, h=r*1.2; ctx.beginPath(); ctx.rect(-w/2,-h/2,w,h); ctx.fill(); ctx.strokeRect(-w/2+8,-h/2+8,w-16,h-16); maxTextW=w*0.78; }
    else if(kind==='triangle'){ const s=r*2.0; ctx.beginPath(); ctx.moveTo(0,-s/2); ctx.lineTo(s/2,s/2); ctx.lineTo(-s/2,s/2); ctx.closePath(); ctx.fill(); ctx.beginPath(); ctx.moveTo(0,-s/2+8); ctx.lineTo(s/2-8,s/2-8); ctx.lineTo(-s/2+8,s/2-8); ctx.closePath(); ctx.stroke(); maxTextW=s*0.74; }
    else if(kind==='star' || kind==='clock' || kind==='shield'){ /* draw handled in subclass */ }
    if(kind==='circle' || kind==='square' || kind==='rect' || kind==='triangle'){ ctx.save(); ctx.rotate(-this.rotation); ctx.textAlign='center'; ctx.textBaseline='middle'; let fontSize=(kind==='circle')?r*0.72:r*0.68; if(kind==='rect'||kind==='triangle') fontSize=r*0.62; ctx.font=`900 ${fontSize}px system-ui,Segoe UI,Roboto`; const label=this.label; let w=ctx.measureText(label).width; let guard=0; while(w>maxTextW && guard<25){ fontSize*=0.92; ctx.font=`900 ${fontSize}px system-ui,Segoe UI,Roboto`; w=ctx.measureText(label).width; guard++; } ctx.lineWidth=Math.max(6,fontSize*0.13); ctx.strokeStyle='rgba(0,0,0,.85)'; ctx.fillStyle='#ffffff'; ctx.strokeText(label,0,4); ctx.fillText(label,0,4); ctx.restore(); }
    ctx.restore();
  }
  contains(px,py){
    const dx = px - this.x; const dy = py - this.y;
    if(this.kind==='circle') return (dx*dx+dy*dy) <= (this.r*this.r);
    if(this.kind==='square'){ const s=this.r*1.5; return (dx>=-s/2 && dx<=s/2 && dy>=-s/2 && dy<=s/2); }
    if(this.kind==='rect'){ const w=this.r*2.2, h=this.r*1.2; return (dx>=-w/2 && dx<=w/2 && dy>=-h/2 && dy<=h/2); }
    if(this.kind==='triangle'){ const s=this.r*2.0; return (dx>=-s/2 && dx<=s/2 && dy>=-s/2 && dy<=s/2); }
    if(this.kind==='star' || this.kind==='clock' || this.kind==='shield') return (dx*dx+dy*dy) <= (this.r*this.r);
  }
}

class PowerUp extends Target{
  constructor(type){
    super('circle');
    this.kind = type; this.life = 1.2; this.r = rand(60,90);
    this.color = type==='star' ? '#facc15' : (type==='clock' ? '#38bdf8' : '#22c55e');
    this.label = '';
  }
  draw(){
    const {x,y,r} = this; ctx.save(); ctx.translate(x,y); ctx.rotate(this.rotation);
    const g=ctx.createRadialGradient(0,0,0,0,0,r*1.4); g.addColorStop(0, this.color + 'aa'); g.addColorStop(1, 'transparent');
    ctx.globalAlpha=0.5; ctx.fillStyle=g; ctx.beginPath(); ctx.arc(0,0,r*1.4,0,Math.PI*2); ctx.fill(); ctx.globalAlpha=1;
    ctx.fillStyle = this.color; ctx.strokeStyle='rgba(255,255,255,.95)'; ctx.lineWidth=8;
    if(this.kind==='star'){ const spikes=5; const outer=r*0.9; const inner=r*0.4; let rot=Math.PI/2*3; let cx=0; let cy=0; let step=Math.PI/spikes; ctx.beginPath(); ctx.moveTo(cx, cy - outer); for(let i=0;i<spikes;i++){ ctx.lineTo(cx + Math.cos(rot)*outer, cy + Math.sin(rot)*outer); rot += step; ctx.lineTo(cx + Math.cos(rot)*inner, cy + Math.sin(rot)*inner); rot += step; } ctx.lineTo(cx, cy - outer); ctx.closePath(); ctx.fill(); ctx.stroke(); }
    else if(this.kind==='clock'){ ctx.beginPath(); ctx.arc(0,0,r*0.9,0,Math.PI*2); ctx.fill(); ctx.stroke(); ctx.strokeStyle='rgba(0,0,0,.6)'; ctx.lineWidth=6; ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(0,-r*0.55); ctx.stroke(); ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(r*0.45,0); ctx.stroke(); }
    else if(this.kind==='shield'){ ctx.beginPath(); ctx.moveTo(0,-r*0.9); ctx.quadraticCurveTo(r*0.9,-r*0.4, r*0.6, r*0.5); ctx.quadraticCurveTo(0, r*0.95, -r*0.6, r*0.5); ctx.quadraticCurveTo(-r*0.9,-r*0.4, 0,-r*0.9); ctx.closePath(); ctx.fill(); ctx.stroke(); }
    ctx.restore();
  }
}

// ===== UI
document.getElementById('how').onclick=()=>{document.getElementById('start').style.display='none'; document.getElementById('howcard').style.display='block'};
document.getElementById('backToStart').onclick=()=>{document.getElementById('howcard').style.display='none'; document.getElementById('start').style.display='block'};
document.getElementById('toggleFS').onclick=()=>{ if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{}); else document.exitFullscreen(); };

document.querySelectorAll('[data-level]').forEach(btn=>{ btn.addEventListener('click',()=>{ currentDiff = DIFFICULTY[btn.getAttribute('data-level')]; startGame(); }); });

function startGame(){
  running=true; timeLeft=currentDiff.time; score=0; combo=1; lives=3; targets=[]; spawnTimer=0; lastTime=performance.now();
  doublePointsTimer=0; timeFreezeTimer=0; shieldCharges=0;
  document.getElementById('start').style.display='none'; document.getElementById('howcard').style.display='none'; document.getElementById('gameover').style.display='none';
  updateHUD(true);
  requestAnimationFrame(loop);
}

function endGame(){
  running=false; updateHUD(false);
  let badge='🐣'; if(score>=21 && score<=50) badge='⚡'; else if(score>=51 && score<=100) badge='🔥'; else if(score>=101) badge='👑';
  const body = `${badge} Subli Gaming\nPuntaje: ${score}\nQuiero reclamar mi premio`;
  const encoded = encodeURIComponent(body);
  const claimNumber = '50422554675';
  const shareUrl = `https://wa.me/${claimNumber}?text=${encoded}`;
  const over = document.getElementById('gameover');
  over.innerHTML = `
    <h1>🏁 ¡Fin de la partida!</h1>
    <p><b>Nivel:</b> ${currentDiff.name}</p>
    <p>Puntaje total: <b>${score}</b></p>
    <div class="banners" style="margin:8px 0 10px">
      <img src="data:image/png;base64,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" alt="Banner 3">
      <img src="data:image/png;base64,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" alt="Banner 4">
    </div>
    <div class="row" style="margin-bottom:10px">
      <button class="btn primary" id="again">Elegir nivel</button>
      <button class="btn" id="claim">Reclamar por WhatsApp</button>
    </div>`;
  document.getElementById('again').onclick=()=>{document.getElementById('start').style.display='block'; over.style.display='none';};
  document.getElementById('claim').onclick=()=>{window.open(shareUrl,'_blank')};
  over.style.display='block';
}

// ===== Input
canvas.addEventListener('pointerdown', e=>{
  if(!running) return;
  const rect = canvas.getBoundingClientRect();
  const x = (e.clientX - rect.left) * (canvas.width / rect.width);
  const y = (e.clientY - rect.top) * (canvas.height / rect.height);
  let hitIndex=-1, best=Infinity;
  for(let i=0;i<targets.length;i++){ if(targets[i].contains(x,y)){ const dx=x-targets[i].x, dy=y-targets[i].y, d=dx*dx+dy*dy; if(d<best){ best=d; hitIndex=i; } } }
  if(hitIndex>-1){
    const t=targets[hitIndex];
    if(!t.hit){
      t.hit=true; targets.splice(hitIndex,1);
      if(t.kind==='circle'){
        let inc = currentDiff.points || 0;
        if(doublePointsTimer>0) inc *= 2;
        inc = Math.floor(inc * combo);
        score = Math.max(0, (score||0) + inc);
        combo = Math.min(10, combo + 0.25);
      } else if(t.kind==='star'){ doublePointsTimer = 10; }
      else if(t.kind==='clock'){ timeFreezeTimer = 5; }
      else if(t.kind==='shield'){ shieldCharges = 1; }
      else {
        score = Math.max(0, (score||0) - 10);
        if(shieldCharges>0){ shieldCharges = 0; } else { lives = Math.max(0, lives-1); }
        combo = 1; shake = 12;
      }
      updateHUD(true);
    }
  } else { combo=1; updateHUD(true); }
});

// ===== Spawning + Loop
let baseSpawnMin=0.55, baseSpawnMax=0.16;
function loop(now){
  if(!running) return;
  const dt = Math.min(0.033,(now-lastTime)/1000); lastTime=now;
  if(timeFreezeTimer>0) timeFreezeTimer -= dt; else timeLeft -= dt;
  if(doublePointsTimer>0) doublePointsTimer -= dt;
  if(timeLeft<=0 || lives<=0){ endGame(); return; }

  spawnTimer -= dt; if(spawnTimer<=0){
    targets.push(new Target());
    if(Math.random()<0.35) targets.push(new Target());
    // power-ups chance
    const r = Math.random();
    if(r<0.06) targets.push(new PowerUp('star'));
    else if(r<0.10) targets.push(new PowerUp('clock'));
    else if(r<0.14) targets.push(new PowerUp('shield'));
    const rateBase = lerp(baseSpawnMin, baseSpawnMax, 1 - (timeLeft/currentDiff.time));
    const rate = rateBase * (currentDiff.spawn ? (1/currentDiff.spawn) : 1);
    spawnTimer = rate;
  }

  for(let i=targets.length-1;i>=0;i--){
    const t=targets[i]; t.update(dt);
    if(t.life<=0){ if(t.kind==='circle'){ lives=Math.max(0,lives-1); combo=1; shake=8; } targets.splice(i,1); }
  }

  ctx.save(); const s=shake; shake=Math.max(0,shake-60*dt);
  ctx.translate((Math.random()*2-1)*s, (Math.random()*2-1)*s);
  ctx.clearRect(-10,-10,canvas.width+20,canvas.height+20);
  const grd=ctx.createLinearGradient(0,0,canvas.width,canvas.height);
  grd.addColorStop(0,'#0b2b5c'); grd.addColorStop(1,'#061a35'); ctx.fillStyle=grd; ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.globalAlpha=0.08; for(let i=0;i<40;i++){ ctx.fillStyle=i%2?'#60a5fa':'#ff2d55'; ctx.beginPath(); ctx.arc((i*97)%canvas.width,(i*173)%canvas.height,(i%7+2)*8,0,Math.PI*2); ctx.fill(); }
  ctx.globalAlpha=1; targets.forEach(t=>t.draw()); ctx.restore();
  updateHUD(true); requestAnimationFrame(loop);
}
</script>
</body>
</html>
